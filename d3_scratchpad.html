<html>
<meta charset="utf-8">
<style> /* set the CSS */

body { font: 12px Arial;}

path {
    stroke: steelblue;
    stroke-width: 2;
    fill: none;
}

.axis path,
.axis line {
    fill: none;
    stroke: grey;
    stroke-width: 1;
    shape-rendering: crispEdges;
}

</style>
<body>
<!-- <div id="visualisation"></div> -->
<!-- load the d3.js library -->
<script src="http://d3js.org/d3.v3.min.js"></script>

Foo
<div id='random_walk' align="center"></div>
Bar
<div id='random_walk_barchar' alight='center'></div>
Spam

<script type="text/javascript">

var UTILS = {
  generateTicks: function(num_ticks, up_prob) {
    /* EMEAScript 2015 supports default parameters! */
    if (num_ticks === undefined) {num_ticks = 100;}
    if (up_prob === undefined) {up_prob = 0.5;}

    var ticks = [];
    for (i = 0; i < num_ticks; i++) {
      ticks.push( (Math.random() < up_prob) ? 1 : -1);
    };
    return ticks;
  },

  cumulativeSum: function(arr) {
    var csum = [];
    /* not sure if reduce would make more sense */
    if (arr.length) {
      csum.push(arr[0]);
      for (i = 1; i < arr.length; i++) {
        csum.push(csum[i-1] + arr[i]);
      }
    }
    return csum;
  },

  getPoints: function(arr) {
    var ret = [];
    for (i = 0; i < arr.length; i++) {
      ret.push({x:i, y:arr[i]});
    }
    return ret;
  },
}

var ticks = UTILS.generateTicks();
var csum = UTILS.cumulativeSum(ticks); //
var points = UTILS.getPoints(csum); // [{x0,y0}, {x1,y1}, ...]

var margin = {top: 50, right: 50, bottom: 50, left: 50};
var width = 800 - margin.left - margin.right;
var height = 500 - margin.top - margin.bottom;

var xScale = d3.scale.linear()
  .domain([0, csum.length])
  .range([0,width]);

var yScale = d3.scale.linear()
  .domain([Math.min.apply(Math, csum), Math.max.apply(Math, csum)])
  .range([height,0]); // we use an inverted range so positive numbers are above negative ones



var xAxis = d3.svg.axis().scale(xScale)
            .orient("bottom") // that's the orientation of the ticks themselves!
      .ticks(5);
var yAxis = d3.svg.axis().scale(yScale)
            .orient("left").ticks(5);

var lineFunc = d3.svg.line()
                .x( function(d) { return xScale(d.x); } )
                .y( function(d) { return yScale(d.y); } )
                .interpolate("linear");

var svgContainer = d3.select('#random_walk').append('svg')
  .attr('width', width + margin.left + margin.right)
  .attr('height', height + margin.top + margin.bottom)
  .append('g')
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svgContainer.append('path')
  .attr('d', lineFunc(points))
  .attr('stroke', 'blue')
  .attr('stroke-width', 2)
  .attr('fill', 'none')
  .on("mouseover", function(d, i) { return alert("value: " + d.y);})
  ;


svgContainer.append('g')
  .attr('class','x axis')
  .attr("transform", "translate(0," + yScale(0) + ")") // so it's in line with the 0 on the y axis - need to fix the margin though
  .call(xAxis);

svgContainer.append('g')
  .attr('class','y axis')
  .call(yAxis);

</script>
</body>
</html>
